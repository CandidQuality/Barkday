<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Barkdayâ„¢ â€¢ Dog â†’ Human Years</title>

  <!-- Share / SEO metadata -->
  <meta name="description" content="Dog-year birthdays: calculate the next one and get a plan for better care." />
  <meta property="og:title" content="Barkdayâ„¢ â€” Dog-Year Birthdays" />
  <meta property="og:description" content="Dog-year birthdays: calculate the next one and get a plan for better care." />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Barkdayâ„¢ â€” Dog-Year Birthdays" />
  <meta name="twitter:description" content="Dog-year birthdays: calculate the next one and get a plan for better care." />

  <style>
    :root{ --bg:#0b0c10; --card:#13151a; --text:#e8ecf1; --muted:#9aa4af; --brand:#4aa3ff; --accent:#6ae3b2; --danger:#ff6b6b; --border:#232734; --shadow:0 6px 24px rgba(0,0,0,.35); }
    :root[data-theme="light"]{ --bg:#f7f8fa; --card:#ffffff; --text:#0f172a; --muted:#475569; --brand:#2563eb; --accent:#059669; --danger:#b91c1c; --border:#e2e8f0; --shadow:0 6px 24px rgba(2,6,23,.08); }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,"Helvetica Neue",Arial}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}

    header{display:flex;gap:16px;align-items:flex-start;justify-content:space-between;margin-bottom:8px}
    .title{display:flex;gap:12px;align-items:center}
    .logo{width:40px;height:40px;border-radius:10px;display:grid;place-items:center;overflow:hidden;background:transparent}
    .logoImg{width:100%;height:100%;object-fit:contain;filter:drop-shadow(0 2px 4px rgba(0,0,0,.25))}
    .logoFallback{width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,var(--brand),var(--accent));display:grid;place-items:center;color:#0b0c10}
    .toggle{appearance:none;border:1px solid var(--border);background:var(--card);color:var(--text);padding:8px 12px;border-radius:12px;cursor:pointer;box-shadow:var(--shadow)}

    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:var(--shadow)}
    h1{font-size:22px;margin:0}
    h2{font-size:18px;margin:0 0 8px}
    label{font-weight:600;display:block;margin:14px 0 6px}
    input[type="number"], select, input[type="date"], input[type="text"]{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:var(--bg);color:var(--text)}
    input[type="range"]{width:100%}
    .row{display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap}
    .row > div{flex:1 1 240px;min-width:220px}
    .muted{color:var(--muted);font-size:14px}
    .divider{height:1px;background:var(--border);margin:12px -16px}

    .kpi{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;margin-top:12px}
    .pill{border:1px solid var(--border);background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(0,0,0,.05));border-radius:14px;padding:10px 12px}
    .pill h3{margin:0 0 6px;font-size:15px;color:var(--muted);font-weight:600}
    .big{font-size:24px;font-weight:800}
    .pill.primary .big{font-size:26px}
    .headline{font-size:28px;font-weight:900;line-height:1.15;margin:0 0 4px}
    .primary{outline:2px solid var(--brand);}

    .btn{appearance:none;border:1px solid var(--border);background:var(--brand);color:white;padding:10px 14px;border-radius:12px;cursor:pointer}
    .btn.secondary{background:transparent;color:var(--text)}

    .cardlist{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
    .gift{border:1px solid var(--border);border-radius:12px;padding:12px}
    .gift h4{margin:0 0 6px}
    .link{background:none;border:0;color:var(--brand);cursor:pointer;text-decoration:underline;padding:0}
    .hero{margin:4px 0 0 44px}
    .warn{background:rgba(255,107,107,.1);border:1px solid var(--danger);color:var(--danger);padding:8px 10px;border-radius:10px;margin:8px 0}

    /* Plan lanes */
    .plan{margin-top:12px}
    .lane{border:1px solid var(--border);border-radius:12px;padding:12px;margin:8px 0;background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(0,0,0,.04))}
    .lane h4{margin:0 0 6px;font-size:15px;color:var(--muted)}
    .lane ul{margin:0;padding-left:18px}
    .lane li{margin:4px 0}

    /* Splash screen */
    .splash{
      position:fixed; inset:0; display:grid; place-items:center;
      background:radial-gradient(1000px 500px at 20% 10%, rgba(255,255,255,.06), transparent),
                 radial-gradient(1000px 500px at 80% 90%, rgba(255,255,255,.05), transparent),
                 var(--bg);
      z-index:9999; transition:opacity .5s ease; opacity:1;
    }
    .splash.hide{ opacity:0; pointer-events:none }
    .splash .logoWrap{width:160px;height:160px;border-radius:20px;display:grid;place-items:center}
    .splash .logoWrap img{width:100%;height:100%;object-fit:contain;filter:drop-shadow(0 6px 16px rgba(0,0,0,.45))}
  </style>
</head>
<body>
  <!-- SPLASH -->
  <div id="splash" class="splash" aria-hidden="true">
    <div class="logoWrap">
      <img alt="Barkday logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhEAAAIVCAYAAABvD60EAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAjISURBVHhe7Z3bjttIGYbg/6xTnDk3cH0WmO9gJ3xwYh5guy7f2mWF6tqF9s1Qm6tqkJ5o8XyS3wKQYd0y+6VwM0Jzv6f7Q5zD2gYhH+qv3b1sQ0Wlq6YfWYo7f/1q6w5wX0wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHB6J1mKQ0lLS3V2dlYtW7ZUQkKC4uPj1a9fP9XV1erq6lJiYqKamhpVVlZKks4666zq0aNHKikp0YwZM/Tpp5+qYcOGioyM1OrVq/XUU0+ppKREhw4d0tDQoKurS5J6enp07ty5JEn19fXq3r17q6mp0bZtW3Xu3FGeNQAAeP6bb75RU1OjgwcPqqWlRfPmzVNhYaHq6uq0bNmy1NXV6eGHH9bzzz+vQ4cOKTExUQkJCSopKdGqVau0Z88e/eabb8rMzNTGjRu1YcOG8i0DAIB1eeCBB2rWrFn66aefFBcXp7S0VMMNN5w2f+3evVNaWqqCggI9+uijqq2tVXV1tXbs2NH3S0lJkqTg4GAtWrSwHn0AAGB9xo0bp7CwUPv27XPhwoVqa2vT5s2bVVdXpy1btujEiRMqLi7W6NGj9cYbb6i0tFQzZszQ0aNH9b///qvDhw9LkhYuXKhvvvlG2dnZ1b59+9SzZ0/V2NiotLRUlZWVWrt2rXzLAwCAddm8eXNaunSpHn/8cSorK1NwcLCmT59e1s8zYcIE5eXlKi8vV2ZmpsrKynTq1Ckdf/31amlp0aFDh/Ttt9/qjTfe0P79+5WamqolS5bohhtuqKurS3V1daqqqlJmZqaef/55Ojo6lJyc1Mcff6zAwEBZWRm1a9dOKSkpcpYGAIB1ePfdd4qPj1dNTY1yc3Pl4MGD6tixo8rIyFBSUqJt27a5fY2NjWratGmSpLq6OtXX12vVqlV68sknFYvF6v+9AACw3sWLF1VYWNjmJ0l6/fXX1bNnT2VmZsr8/HxJSUnp3r17FRISotOnT2vUqFGKjY3VwIED9fXXX+vUqVOe5QEAwLoUFBRo27Ztqre3VxkZGaqqqlJkZKQOHTqkTZs2qufnx3vvvVfZ2dmKiYlRXV2doi+fDwAArDdu3DiVlZVp9+7dys/P14EDB9S2bVtVVFRo0qRJ2rNnj+Li4hQXF6eYmBirVq3S0aNHFR8fr1deeUWNjY0aM2aM+R4DAAB1c+DAAdWrV0+SrN+9e1dJSYlCQ0PVsWNHZWdnq7CwUFlZmeLj4zV37lw9//zz+uabbxQbG6vOnTu7vRQAAHB6uVwuZWVlKi4u1rp16w7b4nXHjh1KTU1VRkZGvR8MAAA8H2EYhpnZRi6Xy1dXV/r4448VEhKigQMH6oMPPqjQ0FCFQiE1NjZaunSp8vPz1b9/f1VVVSk7O1s7duyQJBMnTlR8fLwaN26sOXPm6Msvv1RFRYV27dqpf//+3v9CAAA4Pj6+uZt3KpVK/Xuu+8qPz9fFosFhYWFuV1bW6uGDRtq0aJF+uSTT9SoUSNFR0fr3XffVUZGhqZPn66goEDr1q3T2rVrFR8fr6SkJNXV1ap3795KSkrUqVMnZWRkqLCwUJ07d9bq1av1zDPPaN26dXp8fLw8CwMAgHV5+OGHFRcXpw8//FBCQoLOnj2rG2+8UdnZ2UpLS1NVVaXm5mZlZGSpuro6SdKkSZO0aNEiZWZmKjQ0VDExMcrKyhQXF6f4+HgtXbpUR44c0Y4dO3QZAwCA9bKwsFCXLl3S+vXrVVNTI0kqLCzUq6++qlOnTuqpp57SyZMntWnTJq1atUrZ2dnq3r17+vTTT6qoqFDLli2Vnp6uCRMm6JZbbpGZmZnuMwEAgPV5//334uLi1KhRI2VlZSk2NlZ9fX3l5eUpLS1NQUGBFi9erIYNG6bGxkbl5OTopZde0vDhw/XRRx+poKBAq1ev1uuvv67IyEjZ2dm6++67lZmZqbi4WLVq1dKAAQPUAAAcHiqVytWrV1dXV6eSkhK1a9dOa9eu1cCBAxUTExPO6wIAwKpQq9Vqa2vT0qVLFRISojlz5uj48ePq2LGjKioq1KRJE7Vq1Up9fX2aO3eu6uvrFRMTo8DAQPXs2VNRUZHevXurVq1aWb8HAADEc2tra5WWlmpiYkL///evY8eO6aGHHtLa2pqsrCzNnz9fBQUFOnXqlBYuXJj7fQAAcHqsVqsKCgq0f/9+ZWVl6bHHHtPTTz+tU6dOKS4u1hNPPKFvvvlGUVFRKi0t1dlnn63k5GTl5+fL9z4AAHCa5XIZhsljW19fr71796q8vFyrVq3S5MmTOnjwoGJiYjR16lRFR0drx44dKi4u1s0336xJkybpe++9U0JCAoWFhcrKytKkSRN9+eWXcu8PAAC4QmEYhri4OC1cuFC7du3S6tWrFRISouDgYD311FMaNGiQHn/8cR05cyYAAGByz+4HAAAg+o0BAAAAAGB/0wwAAAAAAAD7mWYAAAAAAACwn2mlBwEAAIYl2ZrXyK0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABuLQEsxCW IjGLR+WOAX/P2EeTyv6b5KBAAAAABJRU5ErkJggg==" />
    </div>
  </div>

  <div class="wrap">
    <header>
      <div class="title">
        <div class="logo" aria-hidden="true">
          <img class="logoImg" alt="Barkday logo"
               src="data:image/png;base64,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" />
          <div class="logoFallback" style="display:none">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 7c0-1.38 1.12-2.5 2.5-2.5S12.5 5.62 12.5 7 11.38 9.5 10 9.5 7.5 8.38 7.5 7Zm6-1c0-1.38 1.12-2.5 2.5-2.5S18.5 4.62 18.5 6 17.38 8.5 16 8.5 13.5 7.38 13.5 6Zm-9 6c0-1.38 1.12-2.5 2.5-2.5S9.5 10.62 9.5 12s-1.12 2.5-2.5 2.5S4.5 13.38 4.5 12Zm14 0c0-1.38 1.12-2.5 2.5-2.5S23.5 10.62 23.5 12s-1.12 2.5-2.5 2.5S18.5 13.38 18.5 12Zm-6.5 4c-2.21 0-4 1.79-4 4h8c0-2.21-1.79-4-4-4Z"/></svg>
          </div>
        </div>
        <h1>Barkdayâ„¢</h1>
      </div>
      <button id="themeToggle" class="toggle" type="button" aria-label="Toggle theme">ðŸŒ™ Dark</button>
    </header>

    <p id="heroLine" class="muted hero">Letâ€™s find out together what your precious friendâ€™s birthdays are, so we can celebrate every single one.</p>

    <section class="card">
      <h2>Dog â†’ Human Years</h2>
      <p class="muted">Evidence-based calculator using AVMA/AKC milestones (15/9 rule) with a <strong>weight-continuous slope</strong> after year 2. Optional UCSD DNA-methylation curve (â‰¥ 1 yr). <em>Calculate/Reset only â€” no auto-recalc.</em></p>
      <div class="divider"></div>

      <div class="row">
        <div>
          <label for="dogName">Dog name</label>
          <input id="dogName" type="text" placeholder="e.g., Flip" />
        </div>
        <div>
          <label for="dob">Birthdate</label>
          <input id="dob" type="date" />
          <div class="muted">Dog age shown under Results.</div>
        </div>
        <div>
          <label for="adultWeight">Expected adult weight (lb)</label>
          <input id="adultWeight" type="range" min="5" max="200" step="5" value="55" />
          <div class="muted">Aging rate uses <em>5-lb steps</em>. <span id="adultWeightVal">55</span> lb</div>
        </div>
        <div>
          <label for="chewer">Chewer level</label>
          <select id="chewer">
            <option>Gentle</option>
            <option selected>Normal</option>
            <option>Power</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Advanced</label>
          <label class="muted"><input id="showEpigenetic" type="checkbox"/> Show science curve (?) (UCSD DNA-methylation, â‰¥1 yr)</label>
          <label class="muted"><input id="smoothMilestones" type="checkbox" checked/> Use smooth milestones (blend around 12 & 24 months)</label>
        </div>
        <div>
          <label for="breed">Breed (optional)</label>
          <input id="breed" type="text" placeholder="e.g., Australian Shepherd" />
          <div class="muted">Notes only â€” math stays weight-based.</div>
        </div>
        <div>
          <label for="breedGroup">Breed group</label>
          <select id="breedGroup">
            <option>Working / Herding</option>
            <option>Sporting</option>
            <option>Hound</option>
            <option>Terrier</option>
            <option>Toy</option>
            <option>Non-Sporting</option>
            <option>Guardian</option>
            <option>Companion</option>
            <option>Mixed / Other</option>
          </select>
          <div id="breedExamples" class="muted" style="margin-top:6px"></div>
        </div>
      </div>

      <div class="row" style="margin-top:8px">
        <label class="muted"><input id="ignoreAge" type="checkbox"/> Ignore age filter</label>
        <label class="muted"><input id="ignoreSize" type="checkbox"/> Ignore size filter</label>
        <label class="muted"><input id="ignoreChewer" type="checkbox"/> Ignore chewer filter</label>
      </div>

      <div class="row" style="margin-top:12px">
        <button id="calcBtn" class="btn" type="button">Calculate</button>
        <button id="resetBtn" class="btn secondary" type="button">Reset</button>
        <button id="shareBtn" class="btn secondary" type="button">Share link</button>
      </div>

      <div id="sizeWarn" class="warn" style="display:none"></div>

      <div class="divider"></div>

      <h2>Results</h2>
      <div class="kpi">
        <div class="pill primary"><div class="headline" id="nextHeadline">â€”</div><div class="big" id="nextBday">â€”</div><div class="muted" id="nextBdayDelta"></div></div>
        <div class="pill"><h3>Dog age today</h3><div class="big" id="dogAge">â€”</div></div>
        <div class="pill"><h3>Human-years estimate</h3><div class="big" id="humanYears">â€”</div><div class="muted" id="slopeNote"></div></div>
      </div>
      <p id="profileLine" class="muted" style="margin:8px 0 0">â€”</p>
      <div id="breedNotes" class="muted" style="margin:6px 0 0"></div>

      <div class="row" style="margin-top:10px">
        <button id="addCalBtn" class="btn" type="button">Add to calendar (birthday)</button>
        <button id="remindBtn" class="btn secondary" type="button">Add 1-week reminder</button>
        <button id="addYearSeries" class="btn secondary" type="button">Add next 3 dog-year birthdays</button>
      </div>

      <div id="epi" class="muted" style="margin-top:10px"></div>

      <div class="divider"></div>

      <h2 id="nextPlanHeading">Next Birthday Plan</h2>
      <div id="nextPlan" class="plan"></div>

      <div class="divider"></div>

      <h2>Gift ideas</h2>
      <button id="loadGifts" class="btn secondary" type="button">Load gift ideas</button>
      <div id="giftMeta" class="muted" style="margin:8px 0"></div>
      <div id="gifts" class="cardlist"></div>
    </section>
  </div>

  <script>
    // THEME
    const root = document.documentElement; const toggleBtn = document.getElementById('themeToggle');
    const savedTheme = localStorage.getItem('barkday-theme') || 'dark';
    root.setAttribute('data-theme', savedTheme === 'light' ? 'light' : 'dark');
    toggleBtn.textContent = savedTheme === 'light' ? 'ðŸŒ™ Dark' : 'â˜€ï¸ Light';
    toggleBtn.addEventListener('click', () => {
      const now = root.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
      root.setAttribute('data-theme', now); localStorage.setItem('barkday-theme', now);
      toggleBtn.textContent = now === 'light' ? 'ðŸŒ™ Dark' : 'â˜€ï¸ Light';
    });

    // Splash: fade out after load
    window.addEventListener('load', () => {
      setTimeout(() => document.getElementById('splash')?.classList.add('hide'), 900);
    });

    // Hidden constants
    const GIFT_FEED_URL = 'https://raw.githubusercontent.com/CandidQuality/dog-birthday-feed/main/dog-gifts.json';

    // Breed meta (examples under selector)
    const GROUP_META = {
      'Working / Herding': { desc:'High-drive problem solvers; thrive on jobs.', examples:['Border Collie','Australian Shepherd','German Shepherd','Belgian Malinois','Corgi'] },
      'Sporting': { desc:'Endurance + retrieving backgrounds; water-confident.', examples:['Labrador','Golden Retriever','Vizsla','GSP','Setter'] },
      'Hound': { desc:'Scent/sight specialists; independent.', examples:['Beagle','Dachshund','Greyhound','Foxhound','Basset'] },
      'Terrier': { desc:'Tenacious hunters; love dig/chase games.', examples:['JRT','Westie','Airedale','Border Terrier'] },
      'Toy': { desc:'Small frames; fragile joints; big personalities.', examples:['Chihuahua','Pomeranian','Yorkie','Maltese','Papillon'] },
      'Non-Sporting': { desc:'Mixed roles; needs vary widely.', examples:['Bulldog','Dalmatian','Poodle (Std)','Boston Terrier'] },
      'Guardian': { desc:'Large/giant protectors; joint management matters.', examples:['Rottweiler','Mastiff','Great Dane','Anatolian','Kuvasz'] },
      'Companion': { desc:'Human-bonded; thrive on routines.', examples:['Cavapoo','Cockapoo','Shih Tzu','Havanese'] },
      'Mixed / Other': { desc:'Profile by observed drive & size.', examples:['Mixed-breed','Rescue','Unknown lineage'] }
    };

    // Short guidance lines
    const GROUPS = {
      'Working / Herding':['High drive: daily jobs/puzzles (herding games, scentwork, obedience chains).','Mental fatigue matters as much as physical; enrichment like snuffle mats and hide-and-seek.','Prevent under-stimulation â†’ boredom behaviors.'],
      'Sporting':['Endurance + retrieve instincts: structured fetch, dock diving, field games.','Watch weight gain; meal-prep measured portions.'],
      'Hound':['Scent/sight tracking: long-line scent walks, lure coursing where safe.','Strong recall training with high-value rewards.'],
      'Terrier':['Channel hunt drive: dig boxes, flirt poles, controlled tug.'],
      'Toy':['Fragility: low-impact play; dental care is critical.','Mind thermoregulation (cold/heat).'],
      'Non-Sporting':['Varied needs; tailor enrichment to individual energy and health.'],
      'Guardian':['Impulse control & neutrality training.','Joint support and moderated growth for large/giant frames.'],
      'Companion':['Human-bonded: reinforce calm independence to reduce separation stress.'],
      'Mixed / Other':['Profile by observed drive (retrieve, scent, herd) rather than labels.']
    };

    // Elements
    const el = id => document.getElementById(id);
    const els = {
      dogName: el('dogName'), dob: el('dob'), adultWeight: el('adultWeight'), adultWeightVal: el('adultWeightVal'),
      chewer: el('chewer'), showEpi: el('showEpigenetic'), smooth: el('smoothMilestones'), breed: el('breed'), breedGroup: el('breedGroup'),
      ignoreAge: el('ignoreAge'), ignoreSize: el('ignoreSize'), ignoreChewer: el('ignoreChewer'),
      calcBtn: el('calcBtn'), resetBtn: el('resetBtn'), shareBtn: el('shareBtn'), sizeWarn: el('sizeWarn'),
      nextHeadline: el('nextHeadline'), nextBday: el('nextBday'), nextBdayDelta: el('nextBdayDelta'),
      dogAge: el('dogAge'), humanYears: el('humanYears'), slopeNote: el('slopeNote'),
      addCal: el('addCalBtn'), remind: el('remindBtn'), addYearSeries: el('addYearSeries'),
      loadGifts: el('loadGifts'), giftMeta: el('giftMeta'), gifts: el('gifts'), heroLine: el('heroLine'), profileLine: el('profileLine'), breedNotes: el('breedNotes'), epi: el('epi')
    };

    // Personalized header line
    function possessive(n){ if(!n) return "your precious friend's"; const t=n.trim(); if(!t) return "your precious friend's"; return /s$/i.test(t)? `${t}â€™` : `${t}â€™s`; }
    function renderHero(){ els.heroLine.textContent = `Letâ€™s find out together what ${possessive(els.dogName.value)} birthdays are, so we can celebrate every single one.`; }
    els.dogName.addEventListener('input', renderHero); renderHero();

    // Breed notes + examples
    function updateBreedNotes(){
      const name = els.dogName.value || 'your dog';
      const breedTxt = (els.breed.value||'').trim();
      const group = els.breedGroup.value;
      const lb = parseInt(els.adultWeight.value,10) || 55;
      els.profileLine.textContent = `Profile: ${name}${breedTxt ? ' â€” ' + breedTxt : ''} â€¢ Group: ${group} â€¢ Weight: ${lb} lb`;
      const notes = GROUPS[group]||[]; els.breedNotes.innerHTML = notes.map(n=>`â€¢ ${n}`).join(' ');
      const meta = GROUP_META[group];
      const bx = document.getElementById('breedExamples');
      if(bx){ bx.textContent = meta ? `${meta.desc} Examples: ${meta.examples.join(', ')}` : ''; }
    }
    ['input','change'].forEach(ev=>{
      els.breed.addEventListener(ev, updateBreedNotes);
      els.breedGroup.addEventListener(ev, updateBreedNotes);
      els.dogName.addEventListener(ev, updateBreedNotes);
      els.adultWeight.addEventListener(ev, updateBreedNotes);
    });
    updateBreedNotes();

    // Slider label (5-lb steps)
    els.adultWeight.addEventListener('input', ()=> {
      const v = Math.round(parseInt(els.adultWeight.value,10)/5)*5;
      els.adultWeight.value = v; els.adultWeightVal.textContent = v;
    });

    // If gifts are showing, re-filter when relevant controls change
    function reloadGiftsIfShown(){ if(els.gifts && els.gifts.children && els.gifts.children.length>0){ loadGifts(); } }
    ['change'].forEach(ev=>{
      els.adultWeight.addEventListener(ev, reloadGiftsIfShown);
      els.chewer.addEventListener(ev, reloadGiftsIfShown);
      els.ignoreAge.addEventListener(ev, reloadGiftsIfShown);
      els.ignoreSize.addEventListener(ev, reloadGiftsIfShown);
      els.ignoreChewer.addEventListener(ev, reloadGiftsIfShown);
    });

    // Helpers
    function daysBetween(a,b){ return Math.floor((b - a) / (24*60*60*1000)); }
    function clamp(n,min,max){ return Math.min(Math.max(n,min),max); }

    // Weight-continuous slope 5â†’7 (soft 7.2 at 200 lb)
    function slopeFromWeight(lb){ const w = clamp(lb, 5, 200); if(w <= 20) return 5; if(w <= 50) return 5 + (w-20)*(1/30); if(w <= 90) return 6 + (w-50)*(1/40); return 7 + (w-90)*(0.2/110); }
    function smoothBlend(x, center, width){ const t = clamp((x - (center - width/2)) / width, 0, 1); return t*t*(3 - 2*t); }
    function humanEqYears(tYears, lb, useSmooth){
      const R = slopeFromWeight(lb);
      if(!useSmooth){
        if(tYears <= 1) return 15*tYears;
        if(tYears <= 2) return 15 + 9*(tYears-1);
        return 24 + R*(tYears-2);
      }
      const f1 = smoothBlend(tYears, 1, 0.25); const slope12 = 15 + f1*(9-15);
      if(tYears <= 2){
        const part0 = Math.min(tYears,1)*15;
        const part1 = tYears>1 ? (tYears-1)*slope12 : 0;
        return part0 + part1;
      }
      const f2 = smoothBlend(tYears, 2, 0.5); const slopePost = 9 + f2*(R-9);
      const upTo2 = humanEqYears(2, lb, true);
      return upTo2 + (tYears-2)*slopePost;
    }
    function nextDogYearDate(dob, currentHumanEq, lb, useSmooth){ // next integer of DOG-YEARS
      const target = Math.floor(currentHumanEq) + 1;
      const now = new Date();
      const yearsNow = daysBetween(dob, now) / 365.2425;
      let lo = yearsNow, hi = yearsNow + 5;
      for(let i=0;i<40;i++){
        const mid=(lo+hi)/2; const h=humanEqYears(mid, lb, useSmooth);
        if(h>=target) hi=mid; else lo=mid;
      }
      const t=(lo+hi)/2;
      return new Date(dob.getTime() + t*365.2425*24*60*60*1000);
    }

    // Confetti (multi-color)
    function confetti(durationMs=1700){
      const canvas = document.createElement('canvas'); canvas.style.position='fixed'; canvas.style.inset='0'; canvas.style.pointerEvents='none';
      canvas.width=innerWidth; canvas.height=innerHeight; document.body.appendChild(canvas);
      const ctx = canvas.getContext('2d');
      const colors=['#4aa3ff','#6ae3b2','#ffd166','#ff6b6b','#a78bfa']; const N=160;
      const parts = Array.from({length:N},()=>({x:Math.random()*canvas.width,y:-20-Math.random()*40,vx:(Math.random()-.5)*4,vy:2+Math.random()*3,g:0.05+Math.random()*0.05,s:4+Math.random()*4,c:colors[Math.floor(Math.random()*colors.length)],r:Math.random()*Math.PI}));
      let start=null; function tick(ts){ if(!start) start=ts; const t=ts-start; ctx.clearRect(0,0,canvas.width,canvas.height);
        for(const p of parts){ p.x+=p.vx; p.y+=p.vy; p.vy+=p.g; p.r+=0.05; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.r); ctx.fillStyle=p.c; ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s); ctx.restore(); }
        if(t<durationMs) requestAnimationFrame(tick); else canvas.remove();
      } requestAnimationFrame(tick);
    }

    // ICS helpers
    function fmtUTC(d){ const pad=n=>String(n).padStart(2,'0'); return d.getUTCFullYear()+pad(d.getUTCMonth()+1)+pad(d.getUTCDate())+'T'+pad(d.getUTCHours())+pad(d.getUTCMinutes())+pad(d.getUTCSeconds())+'Z'; }
    function icsEvent(summary, start, end){ return `BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//Barkday//EN\nBEGIN:VEVENT\nUID:${Date.now()}@barkday\nDTSTAMP:${fmtUTC(new Date())}\nDTSTART:${fmtUTC(start)}\nDTEND:${fmtUTC(end)}\nSUMMARY:${summary}\nEND:VEVENT\nEND:VCALENDAR`; }
    function downloadICS(name, ics){ const blob=new Blob([ics],{type:'text/calendar'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=name; document.body.appendChild(a); a.click(); a.remove(); }

    // Gift loader (robust filtering)
    async function loadGifts(){
      els.gifts.innerHTML=''; els.giftMeta.textContent='Loadingâ€¦';
      try{
        const res = await fetch('https://raw.githubusercontent.com/CandidQuality/dog-birthday-feed/main/dog-gifts.json',{cache:'no-store'});
        const items = await res.json();
        const lb = parseInt(els.adultWeight.value,10);
        const bucket = lb<20?'toy':lb<30?'small':lb<50?'medium':lb<90?'large':'giant';
        const dogYears = parseFloat(els.humanYears.textContent);
        const chewer = (els.chewer.value||'').toLowerCase();

        const getSizes = it => Array.isArray(it.sizes)? it.sizes.map(s=>String(s).toLowerCase())
                              : it.size? String(it.size).toLowerCase().split(/[, \t]+/).filter(Boolean)
                              : [];
        const getChewer = it => (it.chewer? String(it.chewer).toLowerCase(): 'any');
        const getAgeBounds = it => {
          const minDY = it.minDogYears ?? it.minHumanYears ?? it.min_age ?? null;
          const maxDY = it.maxDogYears ?? it.maxHumanYears ?? it.max_age ?? null;
          const tag = (it.ageTag||it.tag||'').toString().toLowerCase();
          if((minDY==null && maxDY==null) && tag){
            if(tag.includes('puppy')) return [0, 1.6];
            if(tag.includes('adult')) return [1.0, 7.0];
            if(tag.includes('senior')) return [7.0, 20.0];
          }
          return [minDY, maxDY];
        };

        const results = [];
        for(const it of items){
          let ok = true; let score = 0;
          const sizes = getSizes(it);
          const sizeMatches = !sizes.length || sizes.includes('any') || sizes.includes(bucket);
          if(!els.ignoreSize.checked && !sizeMatches) ok = false; else if(sizeMatches) score += 1;

          const itemChewer = getChewer(it);
          const chewMatches = itemChewer==='any' || itemChewer===chewer;
          if(!els.ignoreChewer.checked && !chewMatches) ok = false; else if(chewMatches) score += 1;

          const [minA,maxA] = getAgeBounds(it);
          let ageMatches = true;
          if(!isNaN(dogYears) && !els.ignoreAge.checked){
            if(minA!=null) ageMatches = ageMatches && dogYears >= Number(minA);
            if(maxA!=null) ageMatches = ageMatches && dogYears <= Number(maxA);
          }
          if(!els.ignoreAge.checked && !ageMatches) ok = false; else if(ageMatches) score += 1;

          if(ok) results.push({it, score, rnd: Math.random()});
        }

        results.sort((a,b)=> (b.score-a.score) || (a.rnd-b.rnd));
        const top = results.slice(0,12).map(r=>r.it);

        const parts = [];
        parts.push(`filters: size=${bucket}`);
        parts.push(`chewer=${chewer||'normal'}`);
        if(!isNaN(dogYears)) parts.push(`ageâ‰ˆ${dogYears.toFixed(2)} DY`);
        const ignored = [];
        if(els.ignoreSize.checked) ignored.push('size');
        if(els.ignoreChewer.checked) ignored.push('chewer');
        if(els.ignoreAge.checked) ignored.push('age');
        els.giftMeta.textContent = `Showing ${top.length} picks â€¢ ${parts.join(' â€¢ ')}${ignored.length? ' â€¢ ignored: '+ignored.join(', '):''}`;

        els.gifts.innerHTML = top.map(it=>`<div class="gift"><h4>${it.title||'Gift'}</h4><div class="muted">${(it.tag||it.ageTag||'').toString()}</div><div style="margin-top:8px"><a class="link" href="${it.url}" target="_blank" rel="noopener">View</a></div></div>`).join('');
      }catch(e){
        els.giftMeta.textContent='Could not load gift ideas.';
      }
    }

    // Recommendation Matrix (DOG-YEARS) â€” abbreviated sample
    const RECO = {
      "Working / Herding": {
        1:{ lanes:{
          training:["Solidify recall on a 30â€“50 ft line","Add impulse control: door/food releases","Introduce scent puzzles twice weekly"],
          health:["Finish core vaccines / boosters if pending","Discuss spay/neuter timing with vet","Baseline hip/elbow discussion for large lines"],
          nutrition:["Transition to adult formula when growth complete","Measure meals; target ideal BCS 4â€“5/9"],
          exercise:["2 x 30â€“45 min structured walks","Short herding-style games without over-arousal"],
          bonding:["Hide-and-seek indoors","Name recognition games with family"],
          gear:["Long-line (biothane)","Treat pouch with magnet closure"] } },
        2:{ lanes:{
          training:["Loose leash with distractions (add â€˜leave itâ€™)","Start duration place/stay to 10â€“15 min"],
          health:["Annual exam & dental check","Hip/elbow X-ray if symptomatic/high-risk"],
          nutrition:["Maintain protein 24â€“28% (dry matter) depending on output","Add omega-3s if coat/dry skin issues"],
          exercise:["Daily brain work: 15â€“20 min scentwork","Two high-quality fetch sessions/week, flat ground"],
          bonding:["Trick chaining (spinâ†’bowâ†’place)","Field trips to calm public spaces"],
          gear:["Puzzle feeder (level 2)","High-visibility collar for off-lead fields"] } },
        4:{ lanes:{ training:["Proof off-lead recall in fenced area","Refine heel with variable pace"] } },
        7:{ lanes:{ health:["Senior labs baseline (CBC/Chem/UA)","Arthritis check; start joint plan if stiff"] } },
        10:{ lanes:{ gear:["Lightweight ramp","Support harness for car/steps"] } }
      },
      "Sporting": {
        1:{ lanes:{ training:["Retrieve manners: hold/drop on cue","Intro steadiness before fetch release"] } },
        5:{ lanes:{ exercise:["Swim intervals vs repetitive fetch"] } }
      },
      "Toy": {
        1:{ lanes:{ health:["Patella check plan","Dental brushing every other day"] } },
        8:{ lanes:{ exercise:["Multiple 10â€“15 min walks"] } }
      }
    };

    function planFor(group, dogYears){
      const g = RECO[group] || RECO['Mixed / Other'] || {};
      if(g[dogYears]) return g[dogYears];
      const keys = Object.keys(g).map(k=>parseInt(k,10)).sort((a,b)=>a-b);
      if(!keys.length) return null; let lower=null, upper=null;
      for(const k of keys){ if(k <= dogYears) lower=k; if(k >= dogYears && upper===null) upper=k; }
      const chosen = (lower!==null)? lower : upper; return g[chosen]||null;
    }

    function renderPlan(group, upcomingDogYears){
      const container = document.getElementById('nextPlan'); if(!container) return;
      container.innerHTML = '';
      const heading = document.getElementById('nextPlanHeading');
      if(heading){ heading.textContent = `Next Birthday Plan â€” turning ${upcomingDogYears} (dog-years)`; }
      const p = planFor(group, upcomingDogYears);
      if(!p){ container.innerHTML = '<div class="muted">Recommendations coming soon for this group.</div>'; return; }
      const order = [ ['training','Training & Enrichment'], ['health','Health & Wellness'], ['nutrition','Diet & Nutrition'], ['exercise','Exercise Needs'], ['bonding','Play & Bonding Ideas'], ['gear','Helpful Gear (optional)'] ];
      for(const [key,label] of order){
        const items = (p.lanes && p.lanes[key]) ? p.lanes[key] : [];
        if(!items.length) continue;
        const lane = document.createElement('div'); lane.className = 'lane';
        lane.innerHTML = `<h4>${label}</h4>`;
        const ul = document.createElement('ul'); items.forEach(t=>{ const li=document.createElement('li'); li.textContent=t; ul.appendChild(li); });
        lane.appendChild(ul); container.appendChild(lane);
      }
    }

    // CALCULATE
    const updateWeightLabel = ()=> els.adultWeightVal.textContent = els.adultWeight.value; updateWeightLabel();

    function compute(){
      const dobStr = els.dob.value; if(!dobStr){ alert('Please select a birthdate.'); return; }
      const dob = new Date(dobStr); const now = new Date(); if(isNaN(dob.getTime()) || dob>now){ alert('Birthdate is invalid.'); return; }
      const lb = parseInt(els.adultWeight.value,10);

      // Age now (chronological)
      const days = daysBetween(dob, now); const years = days/365.2425; const yrs=Math.floor(years); const months=Math.floor((years%1)*12);
      els.dogAge.textContent = `${yrs}y ${months}m`;

      // Human-equivalent DOG-YEARS
      const H = humanEqYears(years, lb, els.smooth.checked); els.humanYears.textContent = H.toFixed(2); const R = slopeFromWeight(lb); els.slopeNote.textContent = `Râ‰ˆ${R.toFixed(2)} (weight-continuous)`;

      // Next dog-year birthday (DOG-YEARS integer)
      const name = els.dogName.value || 'your dog';
      const upcoming = Math.floor(H)+1; // 15 dog-birthdays within first calendar year by design
      els.nextHeadline.textContent = `${name} is about to be ${upcoming} years old!`;
      const nbd = nextDogYearDate(dob, H, lb, els.smooth.checked); els.nextBday.textContent = nbd.toDateString(); const daysTo = daysBetween(now, nbd); els.nextBdayDelta.textContent = daysTo>0? `${daysTo} days from now` : '';

      // Profile & notes
      const breedTxt=(els.breed.value||'').trim(); const group=els.breedGroup.value; els.profileLine.textContent = `Profile: ${name}${breedTxt ? ' â€” ' + breedTxt : ''} â€¢ Group: ${group} â€¢ Weight: ${lb} lb`;
      const notes = GROUPS[group]||[]; els.breedNotes.innerHTML = notes.map(n=>`â€¢ ${n}`).join(' ');

      // Mismatch hint (non-blocking)
      let warn=''; if(group.includes('Toy') && lb>30) warn='Breed group "Toy" but weight > 30 lb. Math stays weight-based.'; if((group.includes('Guardian')||group.includes('Working')) && lb<20) warn='Breed group suggests large/giant, but weight < 20 lb. Math stays weight-based.'; els.sizeWarn.style.display = warn? 'block':'none'; els.sizeWarn.textContent = warn;

      // Gift meta
      els.giftMeta.textContent = `Gift picks for ${name} â€” by weight ${lb} lb${breedTxt ? ', ' + breedTxt : ''}`;

      // Celebrate + Plan
      els.nextBday.scrollIntoView({behavior:'smooth', block:'center'}); confetti();
      renderPlan(group, upcoming);

      // Keep gifts in sync if already loaded
      if(els.gifts.children.length) loadGifts();
    }

    // EVENTS
    els.calcBtn.addEventListener('click', compute);
    els.resetBtn.addEventListener('click', ()=>{
      els.dogName.value=''; els.dob.value=''; els.adultWeight.value=55; updateWeightLabel(); els.chewer.value='Normal';
      els.showEpi.checked=false; els.smooth.checked=true; els.breed.value=''; els.breedGroup.value='Working / Herding';
      els.ignoreAge.checked=els.ignoreSize.checked=els.ignoreChewer.checked=false;
      els.nextHeadline.textContent='â€”'; els.nextBday.textContent='â€”'; els.nextBdayDelta.textContent='';
      els.dogAge.textContent='â€”'; els.humanYears.textContent='â€”'; els.slopeNote.textContent='';
      els.epi.textContent=''; els.gifts.innerHTML=''; els.giftMeta.textContent='';
      document.getElementById('nextPlan').innerHTML=''; document.getElementById('nextPlanHeading').textContent='Next Birthday Plan';
      els.sizeWarn.style.display='none'; renderHero(); updateBreedNotes();
    });
    els.shareBtn.addEventListener('click', ()=>{
      const p=new URLSearchParams({ n:els.dogName.value||'', d:els.dob.value||'', w:els.adultWeight.value, c:els.chewer.value, g:els.breedGroup.value, r:els.breed.value||'', s:els.smooth.checked?1:0, e:els.showEpi.checked?1:0 });
      const url=location.origin+location.pathname+'?'+p.toString();
      navigator.clipboard.writeText(url).then(()=>alert('Shareable link copied.')).catch(()=>alert(url));
    });

    // ICS buttons
    els.addCal.addEventListener('click', ()=>{
      if(!els.nextBday.textContent || els.nextBday.textContent==='â€”'){ alert('Calculate first.'); return; }
      const start=new Date(els.nextBday.textContent); const end=new Date(start.getTime()+60*60*1000);
      const name=els.dogName.value||'Your dog';
      downloadICS('barkday.ics', icsEvent(`${name} â€” Next Dog-Year Birthday`, start, end));
    });
    els.remind.addEventListener('click', ()=> alert('Reminder integration placeholder: add 1-week reminder.'));
    els.addYearSeries.addEventListener('click', ()=>{
      if(!els.dob.value){ alert('Calculate first.'); return; }
      const name=els.dogName.value||'Your dog'; const dob=new Date(els.dob.value); const lb=parseInt(els.adultWeight.value,10);
      const now=new Date(); const years=daysBetween(dob, now)/365.2425; const H=humanEqYears(years, lb, els.smooth.checked);
      let cur=nextDogYearDate(dob, H, lb, els.smooth.checked); let dogYears=Math.floor(H)+1; let ics='BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//Barkday//EN\n';
      for(let i=0;i<3;i++){
        const start=cur; const end=new Date(start.getTime()+60*60*1000);
        ics+=`BEGIN:VEVENT\nUID:${Date.now()+Math.random()}@barkday\nDTSTAMP:${fmtUTC(new Date())}\nDTSTART:${fmtUTC(start)}\nDTEND:${fmtUTC(end)}\nSUMMARY:${name} â€” Dog-Year ${dogYears}\nEND:VEVENT\n`;
        dogYears++; cur=nextDogYearDate(dob, dogYears-1, lb, els.smooth.checked);
      }
      ics+='END:VCALENDAR'; downloadICS('barkday_series.ics', ics);
    });

    // Gift loader
    els.loadGifts.addEventListener('click', loadGifts);

    // QS hydrate (no auto compute)
    (function initFromQS(){
      const q=new URLSearchParams(location.search);
      if(q.size){
        els.dogName.value=q.get('n')||''; els.dob.value=q.get('d')||''; els.adultWeight.value=q.get('w')||55; els.adultWeightVal.textContent=els.adultWeight.value;
        els.chewer.value=q.get('c')||'Normal'; els.breedGroup.value=q.get('g')||'Working / Herding'; els.breed.value=q.get('r')||'';
        els.smooth.checked=q.get('s')==='1'; els.showEpi.checked=q.get('e')==='1';
        renderHero(); updateBreedNotes();
      }
    })();
  </script>
</body>
</html>
