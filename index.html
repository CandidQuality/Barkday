<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Barkday â€¢ Dog â†’ Human Years (Sizeâ€‘Aware)</title>
  <style>
    :root{ --bg:#0b0c10; --card:#13151a; --text:#e8ecf1; --muted:#9aa4af; --brand:#4aa3ff; --accent:#6ae3b2; --danger:#ff6b6b; --border:#232734; --shadow:0 6px 24px rgba(0,0,0,.35); }
    :root[data-theme="light"]{ --bg:#f7f8fa; --card:#ffffff; --text:#0f172a; --muted:#475569; --brand:#2563eb; --accent:#059669; --danger:#b91c1c; --border:#e2e8f0; --shadow:0 6px 24px rgba(2,6,23,.08); }
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,"Helvetica Neue",Arial}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:16px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:var(--shadow)}
    label{font-weight:600;display:block;margin:14px 0 6px}
    input,select{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:var(--bg);color:var(--text)}
    input[type="range"]{width:100%}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .row>*{flex:1 1 220px}
    .muted{color:var(--muted);font-size:14px}
    .divider{height:1px;background:var(--border);margin:12px -16px}
    .kpi{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:12px}
    .pill{border:1px solid var(--border);border-radius:14px;padding:10px 12px}
    .pill h3{margin:0 0 6px;font-size:15px;color:var(--muted)}
    .big{font-size:24px;font-weight:800}
    .btn{appearance:none;border:1px solid var(--border);background:var(--brand);color:white;padding:10px 14px;border-radius:12px;cursor:pointer}
    .btn.secondary{background:transparent;color:var(--text)}
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Barkday â€¢ Dog â†’ Human Years (Sizeâ€‘Aware)</h1>
    <button id="themeToggle" class="btn secondary" type="button">ðŸŒ™ Dark</button>
  </header>

  <section class="card">
    <h2>Dog â†’ Human Years</h2>
    <div class="divider"></div>

    <div class="row">
      <div><label for="dogName">Dog name</label><input id="dogName" type="text" placeholder="e.g., Flip"></div>
      <div><label for="dob">Birthdate</label><input id="dob" type="date"></div>
      <div><label for="sizeBucket">Size bucket</label>
        <select id="sizeBucket">
          <option value="auto">Auto by weight</option>
          <option value="toy">Toy (&lt;20 lb)</option>
          <option value="small">Small (20â€“29 lb)</option>
          <option value="medium">Medium (30â€“49 lb)</option>
          <option value="large">Large (50â€“89 lb)</option>
          <option value="giant">Giant (90+ lb)</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div><label for="adultWeight">Expected adult weight (lb)</label>
        <input id="adultWeight" type="range" min="3" max="200" step="1" value="60"><div class="muted"><span id="adultWeightVal">60</span> lb</div></div>
      <div><label for="chewer">Chewer level</label>
        <select id="chewer"><option>Gentle</option><option selected>Normal</option><option>Power</option></select>
      </div>
      <div><label for="showEpigenetic">Advanced</label><label class="muted"><input id="showEpigenetic" type="checkbox"> Show epigenetic if â‰¥ 1 yr</label></div>
    </div>

    <div class="row">
      <div><label for="breed">Breed (optional)</label><input id="breed" type="text" placeholder="e.g., Australian Shepherd"></div>
      <div><label for="breedGroup">Breed group</label>
        <select id="breedGroup"><option>Working / Herding</option><option>Sporting</option><option>Hound</option><option>Terrier</option><option>Toy</option><option>Nonâ€‘Sporting</option><option>Guardian</option><option>Companion</option><option>Mixed / Other</option></select>
      </div>
    </div>

    <div class="row" style="margin-top:12px">
      <button id="calcBtn" class="btn" type="button">Calculate</button>
      <button id="resetBtn" class="btn secondary" type="button">Reset</button>
    </div>

    <div class="divider"></div>
    <h2>Results</h2>
    <div class="kpi">
      <div class="pill"><h3>Dog age today</h3><div class="big" id="dogAge">â€”</div></div>
      <div class="pill"><h3>Humanâ€‘years estimate</h3><div class="big" id="humanYears">â€”</div><div class="muted" id="slopeNote"></div></div>
      <div class="pill"><h3>Dog birthday (next)</h3><div class="big" id="dogBday">â€”</div></div>
    </div>
  </section>
</div>

<script>
  const el=id=>document.getElementById(id);
  const els={dogName:el('dogName'),dob:el('dob'),adultWeight:el('adultWeight'),adultWeightVal:el('adultWeightVal'),sizeBucket:el('sizeBucket'),chewer:el('chewer'),showEpi:el('showEpigenetic'),breed:el('breed'),breedGroup:el('breedGroup'),calcBtn:el('calcBtn'),resetBtn:el('resetBtn'),dogAge:el('dogAge'),humanYears:el('humanYears'),slopeNote:el('slopeNote'),dogBday:el('dogBday')};

  els.adultWeight.addEventListener('input',()=>{els.adultWeightVal.textContent=els.adultWeight.value});

  function bucketFromWeight(lb){if(lb<20)return'toy';if(lb<30)return'small';if(lb<50)return'medium';if(lb<90)return'large';return'giant'}
  function slopeForBucket(b){return{toy:5,small:5,medium:5,large:6,giant:7}[b]||5}

  function compute(){
    const dob=new Date(els.dob.value);if(isNaN(dob))return alert('Enter valid DOB');
    const now=new Date();const days=(now-dob)/(1000*60*60*24);const years=days/365.2425;
    const lb=parseInt(els.adultWeight.value,10);const bucket=els.sizeBucket.value==='auto'?bucketFromWeight(lb):els.sizeBucket.value;const R=slopeForBucket(bucket);
    const human=(years>=1?15:years*15)+(years>=2?9:Math.max(years-1,0)*9)+Math.max(years-2,0)*R;
    els.dogAge.textContent=`${Math.floor(years)}y ${Math.floor((years%1)*12)}m`;
    els.humanYears.textContent=human.toFixed(2);
    els.slopeNote.textContent=`R=${R} (${bucket})`;
    const dogBirth=new Date(dob);dogBirth.setFullYear(dogBirth.getFullYear()+Math.floor(years)+1);
    els.dogBday.textContent=dogBirth.toDateString();
  }

  els.calcBtn.addEventListener('click',compute);
  els.resetBtn.addEventListener('click',()=>{els.dogName.value='';els.dob.value='';els.adultWeight.value=60;els.adultWeightVal.textContent='60';els.sizeBucket.value='auto';els.chewer.value='Normal';els.showEpi.checked=false;els.breed.value='';els.breedGroup.value='Working / Herding';els.dogAge.textContent='â€”';els.humanYears.textContent='â€”';els.slopeNote.textContent='';els.dogBday.textContent='â€”'});
</script>
  <script>
    // --- Post-load enhancements: dog-year birthday + gentle size warning (weight-based math preserved)
    (function(){
      const el = id => document.getElementById(id);
      const btn = el('calcBtn');
      const nextEl = el('nextBday');
      if(nextEl){
        const h3 = nextEl.previousElementSibling; if(h3 && h3.tagName==='H3'){ h3.textContent = 'Next dogâ€‘year birthday'; }
        const delta = document.createElement('div'); delta.id='nextBdayDelta'; delta.className='muted'; nextEl.after(delta);
      }
      function bucketFromWeight(lb){ if(lb < 20) return 'toy'; if(lb < 30) return 'small'; if(lb < 50) return 'medium'; if(lb < 90) return 'large'; return 'giant'; }
      function slopeForBucket(bucket){ return {toy:5, small:5, medium:5, large:6, giant:7}[bucket] || 5; }
      function daysBetween(a,b){ return Math.floor((b - a) / (24*60*60*1000)); }
      function nextDogYearDate(dob, currentHumanEq, R){
        const target = Math.floor(currentHumanEq)+1;
        let tYears;
        if(target <= 15){ tYears = target/15; }
        else if(target <= 24){ tYears = 1 + (target-15)/9; }
        else { tYears = 2 + (target-24)/R; }
        const ms = dob.getTime() + tYears*365.2425*24*60*60*1000;
        return new Date(ms);
      }
      function computeHumanEq(dob, weight, sizeBucket){
        const now = new Date();
        const days = daysBetween(dob, now); const years = days/365.2425;
        const bucket = sizeBucket==='auto' ? bucketFromWeight(weight) : sizeBucket;
        const R = slopeForBucket(bucket);
        const firstTwo = Math.min(years, 2);
        const human1 = firstTwo>0 ? (Math.min(firstTwo,1)*15 + Math.max(firstTwo-1,0)*9) : 0;
        const humanTotal = human1 + Math.max(years-2,0)*R;
        return {years, humanTotal, R};
      }
      function extraCompute(){
        const dobStr = el('dob').value; if(!dobStr) return; const dob = new Date(dobStr);
        const weight = parseInt(el('adultWeight').value||'0',10);
        const sizeBucket = el('sizeBucket').value;
        const outHuman = parseFloat((el('humanYears').textContent||'').replace(/[^0-9.\-]/g,''));
        const {humanTotal, R} = isNaN(outHuman) ? computeHumanEq(dob, weight, sizeBucket) : {humanTotal: outHuman, R: slopeForBucket(sizeBucket==='auto'?bucketFromWeight(weight):sizeBucket)};
        const nbd = nextDogYearDate(dob, humanTotal, R);
        el('nextBday').textContent = nbd.toDateString();
        const daysTo = daysBetween(new Date(), nbd); el('nextBdayDelta').textContent = daysTo>0 ? `${daysTo} days from now` : '';
        // Gentle warning if group suggests extreme vs weight
        const bg = (el('breedGroup').value||'').toLowerCase();
        const warnToy = (bg.includes('toy') && weight>30);
        const warnGiant = ((bg.includes('guardian')||bg.includes('working')) && weight<20);
        if(warnToy || warnGiant){
          alert('Headsâ€‘up: breed group suggests a different typical size. The calculator remains weightâ€‘based; adjust size bucket only if you want to change the math.');
        }
      }
      if(btn){ btn.addEventListener('click', extraCompute); }
    })();
  </script>
</body>
</html>
