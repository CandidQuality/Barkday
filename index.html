<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Barkdayâ„¢ â€¢ Dog â†’ Human Years</title>
  <meta name="description" content="Dog-year birthdays: calculate the next one and get a plan for better care." />

  <!-- Preload assets -->
  <link rel="preload" as="image" href="barkday-logo.png?v=3">
  <link rel="preload" as="image" href="barkday-logo2.png?v=2">
  <link rel="stylesheet" href="style.css?v=2" />

  <!-- Favicon / Browser Icons -->
  <link rel="icon" href="favicon.ico" sizes="16x16 32x32 48x48" type="image/x-icon">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="shortcut icon" href="favicon.ico">

  <!-- App Icons -->
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="256x256" href="icon-256.png">
  <link rel="icon" type="image/png" sizes="384x384" href="icon-384.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">

  <!-- Maskable Icons (for Android/PWA) -->
  <link rel="icon" type="image/png" sizes="192x192" href="icon-maskable-192.png" purpose="maskable">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-maskable-512.png" purpose="maskable">

  <!-- Apple Touch -->
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <meta name="apple-mobile-web-app-title" content="Barkdayâ„¢">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#111827">
</head>

<body>
  <!-- SPLASH -->
  <div id="splash" class="splash" aria-hidden="true">
    <div class="logoWrap">
      <img id="logoSplash" alt="Barkday logo" src="">
    </div>
  </div>

  <div class="wrap">
    <header>
      <div class="title">
        <img id="logoHeader" class="logoImg" alt="Barkday logo" src="">
        <h1>Barkdayâ„¢</h1>
      </div>
      <button id="themeToggle" class="toggle" type="button" aria-label="Toggle theme">ðŸŒ™ Dark</button>
    </header>

    <p id="heroLine" class="muted hero">
      Letâ€™s find out together what your precious friendâ€™s birthdays are, so we can celebrate every single one.
    </p>

    <section class="card">
      <h2>Dog â†’ Human Years</h2>
      <p class="muted">
        Evidence-based calculator using AVMA/AKC milestones (15/9 rule) with a
        <strong>weight-continuous slope</strong> after year 2.
        Optional UCSD DNA-methylation curve (â‰¥ 1 yr).
        <em>Calculate/Reset only â€” no auto-recalc.</em>
      </p>
      <div class="divider"></div>

      <div class="row">
        <div>
          <label for="dogName">Dog name</label>
          <input id="dogName" type="text" placeholder="e.g., Sebby" />
        </div>
        <div>
          <label for="dob">Birthdate</label>
          <input id="dob" type="date" />
          <div class="muted">Dog age shown under Results.</div>
        </div>
        <div>
          <label for="adultWeight">Expected adult weight (lb)</label>
          <input id="adultWeight" type="range" min="5" max="200" step="5" value="55" />
          <div class="muted">Aging rate uses <em>5-lb steps</em>. <span id="adultWeightVal">55</span> lb</div>
        </div>
        <div>
          <label for="chewer">Chewer level</label>
          <select id="chewer">
            <option>Gentle</option>
            <option selected>Normal</option>
            <option>Power</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Advanced</label>
          <label class="muted"><input id="showEpigenetic" type="checkbox" /> Show science curve (?) (UCSD DNA-methylation, â‰¥ 1 yr)</label>
          <label class="muted"><input id="smoothMilestones" type="checkbox" checked /> Use smooth milestones (blend around 12 & 24 months)</label>
        </div>
        <div>
          <label for="breed">Breed (optional)</label>
          <input id="breed" type="text" placeholder="e.g., Australian Shepherd" />
          <div class="muted">Notes only â€” math stays weight-based.</div>
        </div>
        <div>
          <label for="breedGroup">Breed group</label>
          <select id="breedGroup">
            <option>Working / Herding</option>
            <option>Sporting</option>
            <option>Hound</option>
            <option>Terrier</option>
            <option>Toy</option>
            <option>Non-Sporting</option>
            <option>Guardian</option>
            <option>Companion</option>
            <option>Mixed / Other</option>
          </select>
          <div id="breedExamples" class="muted" style="margin-top:6px"></div>
        </div>
      </div>

      <div class="row" style="margin-top:8px">
        <label class="muted"><input id="ignoreAge" type="checkbox" /> Ignore age filter</label>
        <label class="muted"><input id="ignoreSize" type="checkbox" /> Ignore size filter</label>
        <label class="muted"><input id="ignoreChewer" type="checkbox" /> Ignore chewer filter</label>
      </div>

      <div class="row" style="margin-top:12px">
        <button id="calcBtn" class="btn" type="button">Calculate</button>
        <button id="resetBtn" class="btn secondary" type="button">Reset</button>
        <button id="shareBtn" class="btn secondary" type="button">Share link</button>
      </div>

      <div id="sizeWarn" class="warn" style="display:none"></div>

      <div class="divider"></div>

      <h2>Results</h2>
      <div class="kpi">
        <div class="pill primary">
          <div class="headline" id="nextHeadline">â€”</div>
          <div class="big" id="nextBday">â€”</div>
          <div class="muted" id="nextBdayDelta"></div>
      <!-- Calendar test buttons (temporary) -->
      <div id="calendar-test" style="margin-top:16px">
        <button id="addCalBtn" class="btn">ðŸŽ‰ Add Barkday (.ics)</button>
        <a id="addGoogleBtn" class="btn secondary" target="_blank" rel="noopener">Add to Google Calendar</a>
      </div>

        </div>
        <div class="pill"><h3>Dog age today</h3><div class="big" id="dogAge">â€”</div></div>
        <div class="pill"><h3>Human-years estimate</h3><div class="big" id="humanYears">â€”</div><div class="muted" id="slopeNote"></div></div>
      </div>
      <p id="profileLine" class="muted" style="margin:8px 0 0">â€”</p>
      <div id="breedNotes" class="muted" style="margin:6px 0 0"></div>

      <div class="row" style="margin-top:10px">
        <button id="addCalBtn" class="btn" type="button">Add to calendar (birthday)</button>
        <button id="remindBtn" class="btn secondary" type="button">Add 1-week reminder</button>
        <button id="addYearSeries" class="btn secondary" type="button">Add next 3 dog-year birthdays</button>
      </div>

      <div id="epi" class="muted" style="margin-top:10px"></div>

      <div class="divider"></div>

      <h2 id="nextPlanHeading">Next Birthday Plan</h2>
      <div id="nextPlan" class="plan"></div>

      <div class="divider"></div>

      <h2>Gift ideas</h2>
      <button id="loadGifts" class="btn secondary" type="button">Load gift ideas</button>
      <div id="giftMeta" class="muted" style="margin:8px 0"></div>
      <div id="gifts" class="cardlist"></div>
    </section>
  </div>

  <script src="app.js?5" defer></script>
  
  <footer style="margin-top:40px;padding:20px 0;text-align:center;font-size:0.9em;color:var(--text-secondary)">
  <p>Â© 2025 <strong>Barkdayâ„¢</strong>. All Rights Reserved.</p>
  <p>
    <a href="privacy.html">Privacy</a> Â· 
    <a href="terms.html">Terms</a>
  </p>
  <p><em>Sebby (our mascot) and I hope this makes you day just a litle brighter. </em></p>
</footer>

<!-- Register PWA service worker -->
<script>
  if ('serviceWorker' in navigator) {
    // IMPORTANT: capital B matches your repo URL (/Barkday/)
    navigator.serviceWorker.register('/Barkday/service-worker.js');
  }
</script>

  
  <!-- Calendar test script (temporary) -->
  <script>
  (function(){
    // TEST placeholders â€“ replace with real state after validation
    const dogName = 'Sebby';
    const nextDogYearAge = 4;
    const startUTC = new Date('2025-10-03T05:00:00Z');
    const endUTC   = new Date('2025-10-03T06:00:00Z');
    const planNotes = [
      'Next Birthday Plan â€” Puppy I (1â€“6 dog-years)',
      '',
      'Training & Enrichment',
      'Marker/engagement; 2â€“3 min sessions',
      'Name game + check-ins',
      'Crate calm with positive entries',
      '',
      'Health & Wellness',
      'Vaccine/dental starter routine',
      'Growth plate care; avoid high jumps',
      '',
      'Diet & Nutrition',
      'Puppy diet; measured meals',
      'Slow feeder to pace eating',
      '',
      'Exercise Needs',
      'Very short sniff-walks',
      'Gentle tug with easy "out"',
      '',
      'Play & Bonding Ideas',
      'Cooperative care (ears/paws)',
      'Calm handling + massage',
      '',
      'Helpful Gear (optional)',
      'Back-clip Y-harness',
      'Snuffle mat'
    ].join('\n');

    const pad = n => String(n).padStart(2,'0');
    const toICalUTC = d => (
      d.getUTCFullYear() +
      pad(d.getUTCMonth()+1) +
      pad(d.getUTCDate()) + 'T' +
      pad(d.getUTCHours()) + pad(d.getUTCMinutes()) + pad(d.getUTCSeconds()) + 'Z'
    );

    function makeICS({uid, startUTC, endUTC, title, notes}){
      return [
        'BEGIN:VCALENDAR',
        'VERSION:2.0',
        'PRODID:-//Barkday//EN',
        'BEGIN:VEVENT',
        `UID:${uid}`,
        `DTSTAMP:${toICalUTC(new Date())}`,
        `DTSTART:${toICalUTC(startUTC)}`,
        `DTEND:${toICalUTC(endUTC)}`,
        `SUMMARY:${title}`,
        `DESCRIPTION:${notes}`,
        'STATUS:CONFIRMED',
        'TRANSP:OPAQUE',
        'BEGIN:VALARM',
        'ACTION:DISPLAY',
        'DESCRIPTION:ðŸŽ One week until Barkday!',
        'TRIGGER:-P7D',
        'END:VALARM',
        'BEGIN:VALARM',
        'ACTION:DISPLAY',
        'DESCRIPTION:ðŸŽ‰ Barkday tomorrow!',
        'TRIGGER:-P1D',
        'END:VALARM',
        'END:VEVENT',
        'END:VCALENDAR'
      ].join('\r\n');
    }

    function makeGoogleCalUrl({startUTC, endUTC, title, notes}){
      const base = 'https://calendar.google.com/calendar/render?action=TEMPLATE';
      const dates = `${toICalUTC(startUTC)}/${toICalUTC(endUTC)}`;
      const params = new URLSearchParams({ text: title, dates, details: notes });
      return `${base}&${params.toString()}`;
    }

    const calBtn = document.getElementById('addCalBtn');
    const gBtn   = document.getElementById('addGoogleBtn');
    if (!calBtn || !gBtn) return;

    const title = `ðŸŽ‰ ${dogName} turns ${nextDogYearAge} dog-years! Happy Barkday!`;

    calBtn.addEventListener('click', () => {
      const ics = makeICS({
        uid: `${Date.now()}@barkday`,
        startUTC, endUTC, title, notes: planNotes
      });
      const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${dogName}-barkday-${nextDogYearAge}DY.ics`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(() => URL.revokeObjectURL(url), 2000);
    });

    gBtn.href = makeGoogleCalUrl({startUTC, endUTC, title, notes: planNotes});
  })();
  </script>
</body>
</html>
